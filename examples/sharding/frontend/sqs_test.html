<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <title>AWS SDK for JavaScript - Browser Getting Started Application</title>
  </head>

  <body>
    <script src="https://sdk.amazonaws.com/js/aws-sdk-2.410.0.min.js"></script>
    <script type="text/javascript">
    	console.log("Script hit")
        // Initialize the Amazon Cognito credentials provider
        AWS.config = {"accessKeyId": "AKIAJA5WW6WDTDJY64UA", 
        			"secretAccessKey": "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"}
        AWS.config.region = 'us-east-1';
        sqs = new AWS.SQS();
        console.log("sqs Initialized")

        var params = {
    		QueueUrl: "https://sqs.us-east-1.amazonaws.com/875814277611/test-queue",
    		VisibilityTimeout: 100 // 10 second wait time
    	};

        sqs.receiveMessage(params, (err, data) => {
	    		if (err) {
	    			console.log("Rejecting")
	    			console.log(err)
	    		} else {
	    			console.log("Resolving")
	    			console.log(data)
	    			console.log(data.Messages)
	    			console.log(data.Messages[0])
	    			console.log(data.Messages[0].ReceiptHandle)

	    			params.ReceiptHandle = data.Messages[0].ReceiptHandle
	    			console.log(params)
			    	
			    	sqs.deleteMessage({
			    			QueueUrl: "https://sqs.us-east-1.amazonaws.com/875814277611/test-queue",
			    			ReceiptHandle: data.Messages[0].ReceiptHandle
			    		}, (err, data) => {
			    		console.log("DELETE RESPONSE RECEIVED")
			    		if (err) {
			    			console.log(err)
			    		} else {
			    			console.log(data)
			    		}
				    });
	    		}
	    	}); 
    </script>
  </body>
</html>